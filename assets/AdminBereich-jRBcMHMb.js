import{c as L,j as e,as as R,g as D,N as $,O as M,f as z,P as B,a1 as U,a8 as N,aa as E,r as d,Y as w,a2 as I,a7 as V,V as O,S as P,ad as H,ae as F,h as G,ac as J}from"./index-wr2dCn2t.js";import{u as Q,a as W,b as K,c as X,A as Y}from"./AdminNavbar-CFcbAGb8.js";import{C as Z}from"./circle-x-CeKVf9aR.js";import{D as _}from"./database-29c3i8KB.js";import{T as q}from"./triangle-alert-DaKNZL7v.js";import{A as ee}from"./activity-DnFhxjFV.js";import"./building-Dbe15So8.js";import"./sun-BB9LCqXH.js";import"./bell-Bt3n6wl1.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=L("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);function ae({className:l,...o}){return e.jsx("div",{className:R("animate-pulse rounded-md bg-gray-200 dark:bg-gray-700",l),...o})}function s({title:l,description:o,icon:x,value:y,change:g,changeType:t="neutral",badge:r,loading:f=!1,onClick:n}){const v={positive:"text-green-600",negative:"text-red-600",neutral:"text-gray-600"}[t],a=t==="positive"?N:t==="negative"?te:null;return e.jsxs(D,{className:`cursor-pointer hover:shadow-md transition-all duration-200 hover:scale-[1.02] ${n?"hover:border-blue-300":""}`,onClick:n,children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:l}),e.jsxs("div",{className:"flex items-center gap-2",children:[r&&e.jsx(z,{variant:r.variant,className:"text-xs",children:r.text}),e.jsx(x,{className:"h-4 w-4 text-muted-foreground"})]})]}),e.jsxs(B,{children:[o&&e.jsx(U,{className:"text-xs text-muted-foreground mb-2",children:o}),e.jsxs("div",{className:"space-y-1",children:[f?e.jsx(ae,{className:"h-8 w-20","data-testid":"skeleton"}):e.jsx("div",{className:"text-2xl font-bold",children:y||"N/A"}),g&&e.jsxs("div",{className:`text-xs flex items-center gap-1 ${v}`,children:[a&&e.jsx(a,{className:"h-3 w-3"}),g]})]})]})]})}function he(){var S;const[,l]=E(),[o,x]=d.useState(!1),[y,g]=d.useState(""),{stats:t,loading:r,error:f}=Q(),{alerts:n,loading:v}=W(),{health:a,loading:j}=K(),{search:C,results:ne,loading:ie}=X(),[se,k]=d.useState(null),[re,b]=d.useState(!1);d.useEffect(()=>{(async()=>{var u;try{const m=localStorage.getItem("user");if(m){const p=JSON.parse(m);p.role==="admin"&&(k(p),b(!0),console.log("✅ Admin user found in localStorage:",p.email))}const A=await fetch("/api/auth/me",{credentials:"include",headers:{"Content-Type":"application/json"}});if(!A.ok){console.log("❌ Auth check failed, redirecting to login"),localStorage.removeItem("user"),sessionStorage.clear(),l("/login");return}const h=await A.json();if(((u=h.user)==null?void 0:u.role)!=="admin"){console.log("❌ User is not admin, redirecting to login"),localStorage.removeItem("user"),sessionStorage.clear(),l("/login");return}localStorage.setItem("user",JSON.stringify(h.user)),k(h.user),b(!0),console.log("✅ Admin authentication verified")}catch(m){console.error("Auth check failed:",m),localStorage.removeItem("user"),sessionStorage.clear(),l("/login")}})()},[l]),d.useEffect(()=>{o?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[o]);const T=c=>{g(c),c.trim()&&C(c)},i=c=>{l(c)};return e.jsxs("div",{className:`min-h-screen bg-gray-50 dark:bg-gray-900 ${o?"dark":""}`,children:[e.jsx(Y,{alertCount:(n==null?void 0:n.unread)||0,onSearch:T,darkMode:o,onDarkModeToggle:()=>x(!o)}),e.jsxs("div",{className:"pt-20 pb-8 px-4 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Admin Dashboard"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Verwaltung der gesamten Trustup24 Plattform"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(s,{title:"Gesamt Anbieter",icon:w,value:t==null?void 0:t.totalAgencies,change:`+${Math.round(((t==null?void 0:t.totalAgencies)||0)*.12)} diese Woche`,changeType:"positive",loading:r,onClick:()=>i("/admin/agencies")}),e.jsx(s,{title:"Aktive Leads",icon:I,value:t==null?void 0:t.totalLeads,change:`${(t==null?void 0:t.conversionRate)||0}% Conversion Rate`,changeType:"positive",loading:r,onClick:()=>i("/admin/leads")}),e.jsx(s,{title:"Monatlicher Umsatz",icon:V,value:t!=null&&t.monthlyRevenue?`€${t.monthlyRevenue.toLocaleString()}`:"€0",change:"+18% vs. letzter Monat",changeType:"positive",loading:r,onClick:()=>i("/admin/revenue")}),e.jsx(s,{title:"System Status",icon:(a==null?void 0:a.overall)==="healthy"?O:Z,value:(a==null?void 0:a.overall)||"Loading...",change:`${Math.round((a==null?void 0:a.api.uptime)||0)}h Uptime`,changeType:(a==null?void 0:a.overall)==="healthy"?"positive":"negative",loading:j,badge:{text:(a==null?void 0:a.overall)==="healthy"?"Online":"Offline",variant:(a==null?void 0:a.overall)==="healthy"?"default":"destructive"},onClick:()=>i("/admin/system-health")})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(s,{title:"Anbieter-Verwaltung",description:"Anbieter genehmigen und verwalten",icon:P,value:`${(t==null?void 0:t.pendingVerifications)||0} wartend`,badge:t!=null&&t.pendingVerifications?{text:`${t.pendingVerifications}`,variant:"destructive"}:void 0,onClick:()=>i("/admin/agencies"),loading:r}),e.jsx(s,{title:"Trust Score System",description:"Bewertungssystem überwachen",icon:N,value:`Ø ${(t==null?void 0:t.averageTrustScore)||0}`,change:"Durchschnittlicher Trust Score",onClick:()=>i("/admin/trust-scores"),loading:r}),e.jsx(s,{title:"System-Monitoring",description:"Performance und Analytics",icon:_,value:(a==null?void 0:a.database.status)||"Loading...",change:`${(a==null?void 0:a.database.responseTime)||0}ms Response Time`,changeType:(a==null?void 0:a.database.status)==="healthy"?"positive":"negative",onClick:()=>i("/admin/monitoring"),loading:j}),e.jsx(s,{title:"Benutzer-Verwaltung",description:"Kunden und Anbieter verwalten",icon:w,value:t==null?void 0:t.totalUsers,change:"+8% neue Registrierungen",changeType:"positive",onClick:()=>i("/admin-benutzerverwaltung"),loading:r}),e.jsx(s,{title:"Bewertungen",description:"Reviews und Feedback verwalten",icon:H,value:t==null?void 0:t.totalReviews,change:"Letzte 24h: +12 neue Reviews",changeType:"positive",onClick:()=>i("/admin/reviews"),loading:r}),e.jsx(s,{title:"Analytics & Reports",description:"Umfassende Berichte und Statistiken",icon:F,value:"24 Reports",change:"3 neue Reports verfügbar",onClick:()=>i("/admin/analytics")}),e.jsx(s,{title:"System Alerts",description:"Warnungen und Benachrichtigungen",icon:q,value:`${(n==null?void 0:n.total)||0} Alerts`,badge:n!=null&&n.unread?{text:`${n.unread} ungelesen`,variant:"destructive"}:void 0,changeType:(S=n==null?void 0:n.critical)!=null&&S.length?"negative":"positive",onClick:()=>i("/admin/alerts"),loading:v}),e.jsx(s,{title:"Audit Logs",description:"System- und Benutzeraktivitäten",icon:G,value:"Logs",change:"Letzte Aktivität vor 2 Min.",onClick:()=>i("/admin/audit-logs")}),e.jsx(s,{title:"Plattform-Einstellungen",description:"Grundeinstellungen der Plattform",icon:J,value:"Config",change:"Zuletzt aktualisiert: Heute",onClick:()=>i("/admin-einstellungen")})]}),(t==null?void 0:t.recentActivity)&&t.recentActivity.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Letzte Aktivitäten"}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:e.jsx("div",{className:"space-y-4",children:t.recentActivity.slice(0,5).map((c,u)=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100 dark:border-gray-700 last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ee,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-900 dark:text-white",children:c.description||"Aktivität"})]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(c.timestamp).toLocaleString()})]},u))})})]})]})]})}export{he as default};
